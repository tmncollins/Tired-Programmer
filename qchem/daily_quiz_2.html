<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Challenge Quiz</title>
<style>
  :root{
    --bg:#121213;
    --tile-border:#3a3a3c;
    --text:#d7dadc;
    --muted:#a3a6aa;
    --accent:#6aaa64;
    --btn:#3a3a3c;
    --btn-hover:#565758;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background: var(--bg);
    color: var(--text);
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
    padding: 16px;
  }
  .quiz-container {
    background: var(--bg);
    border: 1px solid var(--tile-border);
    padding: 20px 16px 16px;
    border-radius: 12px;
    width: 100%;
    max-width: 420px;
    text-align: center;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  }
  .option-grid{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:8px;
    margin-top: 10px;
  }
  .option-btn{
    background: var(--btn);
    border: 2px solid var(--tile-border);
    border-radius:8px;
    cursor:pointer;
    padding:0;
    transition: transform 0.08s ease, background-color 0.08s ease;
  }
  .option-btn img{width:100%; display:block; border-radius:8px;}
  .option-btn:hover{
    transform: scale(0.96);
    background-color: #d3d3d3;
    border-color: #8b8c8e;
    filter: brightness(0.9);
  }
  .primary-btn{
    display:block;
    width:100%;
    padding:14px 12px;
    margin-top:10px;
    background: var(--accent);
    color: #fff;
    border:2px solid var(--accent);
    border-radius:8px;
    font-weight:800;
    cursor:pointer;
    transition: transform 0.08s ease, background-color 0.08s ease, border-color 0.08s ease;
  }
  .primary-btn:hover{
    transform: scale(0.96);
    filter: brightness(0.9);
  }

  .option-btn.correct, .primary-btn.correct {
    background: #1a1a1b;
    border: 5px solid #538d4e !important;
    border-radius:12px;
  }
  .option-btn.incorrect, .primary-btn.incorrect {
    background: #1a1a1b;
    border: 5px solid #b91d1d !important;
    border-radius:12px;
  }
  .result-box{
    background: #1a1a1b;
    border:1px solid var(--tile-border);
    border-radius:10px;
    padding:12px;
    margin:10px 0 6px;
  }
  .progress-dots {
    display: flex;
    justify-content: center;
    margin-top: 20px;
    gap: 8px;
  }
  .progress-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #3a3a3c;
    transition: background-color 0.2s ease;
  }
  .progress-dot.correct { background-color: #538d4e; }
  .progress-dot.incorrect { background-color: #b91d1d; }
  .progress-dot.current { outline: 2px solid white; }
  }
  .dot{
    width:10px;
    height:10px;
    border-radius:50%;
    background: var(--tile-border);
    transition: background 0.3s;
  }
  .dot.active{
    background: var(--accent);
  }
</style>
</head>
<body>
<div class="quiz-container" id="container">
  <h2 id="title">Loading...</h2>
  <div id="content"></div>
  <div id="progress" class="progress-dots"></div>
</div>
<script>
const dailyQuestions = {
  "2025-08-13": [
    { q: '<img src="2025-08-14/question_1.png" alt="13C-NMR" style="max-width:100%;border-radius:8px;">',
      options: [
        '<img src="question_1_1.png" alt="Product 1">',
        '<img src="question_1_2.png" alt="Product 2">',
        '<img src="question_1_3.png" alt="Product 3">',
        '<img src="question_1_4.png" alt="Product 4">'
      ],
      answer: 0
    },
    { q: "Which gas do plants absorb?", options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Helium"], answer: 1 },
    { q: "What is 2 + 2?", options: ["3", "4", "5", "6"], answer: 1 },
    { q: "Which planet is known as the Red Planet?", options: ["Earth", "Mars", "Jupiter", "Saturn"], answer: 1 }
  ],
  "2025-08-14": [
    { q: '<img src="2025-08-14/question_1.png" alt="13C-NMR" style="max-width:100%;border-radius:8px;">',
      options: [
        '<img src="2025-08-14/question_1_1.png" alt="Product 1">',
        '<img src="2025-08-14/question_1_2.png" alt="Product 2">',
        '<img src="2025-08-14/question_1_3.png" alt="Product 3">',
        '<img src="2025-08-14/question_1_4.png" alt="Product 4">'
      ],
      answer: 0
    },
    { q: '<img src="2025-08-14/question_2.png" alt="Suzuki Reaction" style="max-width:100%;border-radius:8px;">',
      options: [
        '<img src="2025-08-14/question_2_1.png" alt="Product 1">',
        '<img src="2025-08-14/question_2_2.png" alt="Product 2">',
        '<img src="2025-08-14/question_2_3.png" alt="Product 3">',
        '<img src="2025-08-14/question_2_4.png" alt="Product 4">'
      ],
      answer: 1
    },
    { q: "Which salt has the highest Lattice Enthalpy?", options: ["LiCl", "LiI", "MgCl", "MgI"], answer: 3 },
    { q: "Which transition metal ion will have the most Jahn-Teller distorted complexes?", options: ["Mn<sup>2+</sup>", "Cr2+", "Cr3+", "Cu1+"], answer: 1 }
  ],
  "2025-08-15": [
    { q: '<img src="2025-08-15/question_1.png" alt="13C-NMR" style="max-width:100%;border-radius:8px;">',
      options: [
        '<img src="2025-08-15/question_1_1.png" alt="Product 1">',
        '<img src="2025-08-15/question_1_2.png" alt="Product 2">',
        '<img src="2025-08-15/question_1_3.png" alt="Product 3">',
        '<img src="2025-08-15/question_1_4.png" alt="Product 4">'
      ],
      answer: 0
    },
    { q: "Which reducing agent will selectively reduce a ketone but not an aldehyde?", options: ["DIBAL", "LiAlH4", "NaBH4, CeCl3", "H2, Pd/C"], answer: 2 },
    { q: "Which organic acid has the lowest pKa?",
      options: [
        '<img src="2025-08-15/question_3_1.png" alt="Acid 1">',
        '<img src="2025-08-15/question_3_2.png" alt="Acid 2">',
        '<img src="2025-08-15/question_3_3.png" alt="Acid 3">',
        '<img src="2025-08-15/question_3_4.png" alt="Acid 4">'
      ],
      answer: 2
    },
    { q: "Which transition metal ion will have the most Jahn-Teller distorted complexes?", options: ["Mn<sup>2+</sup>", "Cr2+", "Cr3+", "Cu1+"], answer: 1 }
  ]


};

function getTodayKey(){return new Date().toISOString().split('T')[0];}
function getCookie(name){const value = "; " + document.cookie;const parts = value.split("; " + name + "=");if(parts.length===2) return parts.pop().split(";").shift();}
function setCookie(name,value,days){let expires="";if(days){const date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}document.cookie=name+"="+(value||"")+expires+"; path=/";}

const todayKey=getTodayKey();
let questions=dailyQuestions[todayKey]||dailyQuestions["2025-08-13"];
let currentQuestion=0,score=0, answersStatus=[];
let streak=parseInt(getCookie("quizStreak"))||0;
let lastPlayed=getCookie("quizLastPlayed");
if(lastPlayed){const y=new Date();y.setDate(y.getDate()-1);const yKey=y.toISOString().split('T')[0];if(lastPlayed===yKey){streak++;}else if(lastPlayed!==todayKey){streak=0;}}
const savedScore=getCookie("quizScore-"+todayKey);
if(savedScore!==undefined){
  document.getElementById("title").innerText="QChem";
  document.getElementById("content").innerHTML=`<p>You've already played today!</p><p>Your score today: <strong>${savedScore} / ${questions.length}</strong></p><p>Your streak: <strong>${streak} days</strong></p>`;
}else{
  document.getElementById("title").innerText="QChem";
  document.getElementById("content").innerHTML=`<p>Your streak: <strong>${streak} days</strong></p><button class="primary-btn" onclick="startQuiz()">Start Quiz</button>`;
}
function startQuiz(){renderDots();loadQuestion();
  answersStatus = Array(4).fill(null);
}
function loadQuestion(){
  if(currentQuestion>=questions.length){endQuiz();return;}
  renderDots();
  const qData=questions[currentQuestion];
  document.getElementById("title").innerHTML=qData.q;
  const contentDiv=document.getElementById("content");
  contentDiv.innerHTML="";
  if(qData.q.includes('<img')){
    const grid=document.createElement("div");
    grid.className="option-grid";
    qData.options.forEach((opt,idx)=>{
      const btn=document.createElement("button");
      btn.className="option-btn";
      btn.innerHTML=opt;
      btn.onclick=()=>selectAnswer(idx);
      grid.appendChild(btn);
    });
    contentDiv.appendChild(grid);
  }else{
    qData.options.forEach((opt,idx)=>{
      const btn=document.createElement("button");
      btn.className="primary-btn";
      btn.innerText=opt;
      btn.onclick=()=>selectAnswer(idx);
      contentDiv.appendChild(btn);
    });
  }
}
function renderDots() {
  const progressContainer = document.getElementById("progress");
  progressContainer.innerHTML = "";
  for (let i = 0; i < questions.length; i++) {
    const dot = document.createElement("div");
    dot.className = "progress-dot";
    if (answersStatus[i] === "correct") dot.classList.add("correct");
    if (answersStatus[i] === "incorrect") dot.classList.add("incorrect");
    progressContainer.appendChild(dot);
  }
}
function selectAnswer(idx) {
  const qData = questions[currentQuestion];
  const buttons = document.querySelectorAll(".option-btn, .primary-btn");
  
  if (idx === qData.answer) {
    score++;
    answersStatus[currentQuestion] = "correct";
    buttons[idx].classList.add("correct");
  } else {
    answersStatus[currentQuestion] = "incorrect";
    buttons[idx].classList.add("incorrect");
    buttons[qData.answer].classList.add("correct");
  }

  renderDots();
  buttons.forEach(btn => btn.disabled = true);

  setTimeout(() => {
    currentQuestion++;
    loadQuestion();
  }, 800);
}
function endQuiz(){
  document.getElementById("title").innerText="QChem Complete!";
  document.getElementById("content").innerHTML=`<div class="result-box">Your score today: <strong>${score} / ${questions.length}</strong></div><button class="primary-btn" onclick="shareScore()">Share Your Score</button>`;
  setCookie("quizScore-"+todayKey,score,1);
  setCookie("quizLastPlayed",todayKey,365);
  setCookie("quizStreak",streak,365);
}
function shareScore(){
  const shareText=`I scored ${score} / ${questions.length} on today's QChem. Try to beat me!`;
  if(navigator.share){navigator.share({title:"QChem Score",text:shareText,url:window.location.href}).catch(console.error);}else{
    navigator.clipboard.writeText(shareText).then(()=>{alert("Score copied to clipboard! Share it anywhere.");});
  }
}
</script>
</body>
</html>
